# Prometheus Configuration for Divan
# Sends metrics to Grafana Cloud + local scraping

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    environment: 'local'
    app: 'divan'

# Remote write to Grafana Cloud
remote_write:
  - url: https://prometheus-prod-32-prod-ca-east-0.grafana.net/api/prom/push
    basic_auth:
      username: "2848563"
      password: "glc_eyJvIjoiMTYxMTEyMyIsIm4iOiJzdGFjay0xNDYyMTY1LWFsbG95LWRpdmFuLXByb21ldGhldXMiLCJrIjoiSFkxaWFlTzc4Q0w3WkczQTM0TG1BODIwIiwibSI6eyJyIjoicHJvZC1jYS1lYXN0LTAifX0="

# Alert rules
rule_files:
  - 'rules-phase8.yml'

# Scrape configuration
scrape_configs:
  # Backend service metrics
  - job_name: 'divan-backend'
    metrics_path: '/metrics'
    static_configs:
      - targets: ['backend:8000']
        labels:
          service: 'backend'
    scrape_interval: 10s
    scrape_timeout: 5s

  # Backend health endpoint (for availability tracking)
  - job_name: 'divan-backend-health'
    metrics_path: '/api/health'
    static_configs:
      - targets: ['backend:8000']
        labels:
          service: 'backend'
          check: 'health'
    scrape_interval: 30s
    scrape_timeout: 10s

  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

